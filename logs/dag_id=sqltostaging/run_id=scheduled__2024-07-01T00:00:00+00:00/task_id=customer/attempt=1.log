[2024-07-02T18:42:24.367+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:42:24.389+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:42:24.393+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T18:42:24.446+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T18:42:24.481+0000] {standard_task_runner.py:60} INFO - Started process 100 to run task
[2024-07-02T18:42:24.499+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpst5lbung']
[2024-07-02T18:42:24.516+0000] {standard_task_runner.py:88} INFO - Job 9: Subtask customer
[2024-07-02T18:42:24.679+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 5b7251376729
[2024-07-02T18:42:25.709+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T18:42:25.716+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
TypeError: process_table() missing 1 required positional argument: 'table_type'
[2024-07-02T18:42:25.755+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T184224, end_date=20240702T184225
[2024-07-02T18:42:25.940+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 9 for task customer (process_table() missing 1 required positional argument: 'table_type'; 100)
[2024-07-02T18:42:25.979+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T18:42:26.079+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T18:50:28.334+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:50:28.363+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:50:28.368+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T18:50:28.407+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T18:50:28.427+0000] {standard_task_runner.py:60} INFO - Started process 92 to run task
[2024-07-02T18:50:28.456+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpe63uezm6']
[2024-07-02T18:50:28.461+0000] {standard_task_runner.py:88} INFO - Job 10: Subtask customer
[2024-07-02T18:50:28.586+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host e236fd1115af
[2024-07-02T18:50:29.655+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T18:50:29.660+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T18:50:29.664+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T18:50:29.672+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T18:50:29.689+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 25, in some_function
    sourceDF = getDF(yaml.getSourceDBName(), yaml.getTSourceTableName(),yaml.getSourceSchema())
  File "/app/myFramework/utils/readYaml.py", line 25, in getSourceDBName
    return self.getYaml()['SourceDBName']
  File "/app/myFramework/utils/readYaml.py", line 18, in getYaml
    return yaml_data[self.key]
KeyError: 'public.customer'
[2024-07-02T18:50:29.705+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T185028, end_date=20240702T185029
[2024-07-02T18:50:29.738+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 10 for task customer ('public.customer'; 92)
[2024-07-02T18:50:29.793+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T18:50:29.813+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:20:13.204+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:20:13.323+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:20:13.324+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:20:13.373+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:20:13.385+0000] {standard_task_runner.py:60} INFO - Started process 102 to run task
[2024-07-02T20:20:13.397+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpmvy9oa4z']
[2024-07-02T20:20:13.408+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask customer
[2024-07-02T20:20:13.799+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 881b4526a2de
[2024-07-02T20:20:15.144+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:20:15.154+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:20:15.156+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:20:15.159+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:20:15.192+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 29, in some_function
    print(get_data_from_conf_table("staff", "SqlToStaging"))
  File "/app/myFramework/utils/utils.py", line 137, in get_data_from_conf_table
    cur = conn.getCursor("Postgres")
  File "/app/myFramework/source/posgresql/connect.py", line 6, in getCursor
    conn = psycopg2.connect(database = dbname,
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "postgres_db" (172.20.0.3), port 9999 failed: FATAL:  database "Postgres" does not exist

[2024-07-02T20:20:15.210+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T202013, end_date=20240702T202015
[2024-07-02T20:20:15.221+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 15 for task customer (connection to server at "postgres_db" (172.20.0.3), port 9999 failed: FATAL:  database "Postgres" does not exist
; 102)
[2024-07-02T20:20:15.237+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:20:15.297+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:22:14.197+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:22:14.209+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:22:14.211+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:22:14.235+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:22:14.253+0000] {standard_task_runner.py:60} INFO - Started process 93 to run task
[2024-07-02T20:22:14.256+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpmchogrzf']
[2024-07-02T20:22:14.260+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask customer
[2024-07-02T20:22:14.417+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host b2ca66e4d1f6
[2024-07-02T20:22:15.874+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:22:15.876+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:22:15.876+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:22:15.883+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:22:16.055+0000] {logging_mixin.py:188} INFO -    0      1          2       3     4   ...    10    11    12            13    14
0   9  staff  dvdrental  public  full  ...  None  None  None  SqlToStaging  None

[1 rows x 15 columns]
[2024-07-02T20:22:16.082+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:22:16.109+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T202214, end_date=20240702T202216
[2024-07-02T20:22:16.163+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:22:16.207+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:25:37.640+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:25:37.667+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:25:37.675+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:25:37.724+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:25:37.761+0000] {standard_task_runner.py:60} INFO - Started process 99 to run task
[2024-07-02T20:25:37.786+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '11', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpvy2aiu7y']
[2024-07-02T20:25:37.807+0000] {standard_task_runner.py:88} INFO - Job 11: Subtask customer
[2024-07-02T20:25:37.972+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host e847a37dafab
[2024-07-02T20:25:39.090+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:25:39.095+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:25:39.097+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:25:39.101+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:25:39.296+0000] {logging_mixin.py:188} INFO - <class 'pandas.core.frame.DataFrame'>
[2024-07-02T20:25:39.335+0000] {logging_mixin.py:188} INFO -    id sourcetablename sourcedbname  ...  code         stage last_run_date
0   9           staff    dvdrental  ...  None  SqlToStaging          None

[1 rows x 15 columns]
[2024-07-02T20:25:39.344+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:25:39.359+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T202537, end_date=20240702T202539
[2024-07-02T20:25:39.398+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:25:39.459+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:33:53.744+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:33:53.766+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:33:53.772+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:33:53.811+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:33:53.831+0000] {standard_task_runner.py:60} INFO - Started process 98 to run task
[2024-07-02T20:33:53.836+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpy28r1iww']
[2024-07-02T20:33:53.865+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask customer
[2024-07-02T20:33:54.238+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 99fbc1087931
[2024-07-02T20:33:55.330+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:33:55.334+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:33:55.343+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:33:55.347+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:33:55.401+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SourceDBName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 30, in some_function
    print(f"{df['SourceDBName']} \n {df['SourceTableName']} \n {df['SourceSchema']}")
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'SourceDBName'
[2024-07-02T20:33:55.418+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T203353, end_date=20240702T203355
[2024-07-02T20:33:55.434+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 13 for task customer ('SourceDBName'; 98)
[2024-07-02T20:33:55.470+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:33:55.492+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:36:08.036+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:36:08.042+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:36:08.046+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:36:08.076+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:36:08.086+0000] {standard_task_runner.py:60} INFO - Started process 101 to run task
[2024-07-02T20:36:08.098+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp0hc2bweg']
[2024-07-02T20:36:08.112+0000] {standard_task_runner.py:88} INFO - Job 17: Subtask customer
[2024-07-02T20:36:08.265+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 8ef3b2afa95a
[2024-07-02T20:36:08.375+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:36:08.383+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:36:08.389+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:36:08.392+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:36:08.442+0000] {logging_mixin.py:188} INFO - 0    dvdrental
Name: sourcedbname, dtype: object 
 0    staff
Name: sourcetablename, dtype: object 
 0    public
Name: sourceschema, dtype: object
[2024-07-02T20:36:08.450+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:36:09.222+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T203608, end_date=20240702T203609
[2024-07-02T20:36:09.310+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:36:09.330+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:40:31.434+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:40:31.517+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:40:31.520+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:40:31.582+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:40:31.609+0000] {standard_task_runner.py:60} INFO - Started process 101 to run task
[2024-07-02T20:40:31.632+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8ft6bafx']
[2024-07-02T20:40:31.653+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask customer
[2024-07-02T20:40:31.866+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host f7a45131ad00
[2024-07-02T20:40:33.306+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:40:33.309+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:40:33.310+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:40:33.310+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:40:33.341+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 29, in some_function
    df = get_data_from_conf_table(table, stage)
  File "/app/myFramework/utils/utils.py", line 142, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-02T20:40:33.354+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T204031, end_date=20240702T204033
[2024-07-02T20:40:33.364+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task customer (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 101)
[2024-07-02T20:40:33.408+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:40:33.419+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:44:45.180+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:44:45.199+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:44:45.205+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:44:45.227+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:44:45.256+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-02T20:44:45.262+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8yv250nj']
[2024-07-02T20:44:45.292+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask customer
[2024-07-02T20:44:45.491+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 28c1247628aa
[2024-07-02T20:44:46.716+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:44:46.718+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:44:46.718+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:44:46.719+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:customer
[2024-07-02T20:44:46.721+0000] {logging_mixin.py:188} INFO - sqltostaging customer
[2024-07-02T20:44:46.722+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:44:46.737+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T204445, end_date=20240702T204446
[2024-07-02T20:44:46.804+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:44:46.816+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:47:20.734+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:47:20.751+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:47:20.752+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:47:20.796+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:47:20.816+0000] {standard_task_runner.py:60} INFO - Started process 94 to run task
[2024-07-02T20:47:20.827+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '11', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpyiiofg39']
[2024-07-02T20:47:20.843+0000] {standard_task_runner.py:88} INFO - Job 11: Subtask customer
[2024-07-02T20:47:20.982+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 0dbf5a897656
[2024-07-02T20:47:21.164+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:47:21.179+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:47:21.181+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:47:21.181+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
TypeError: execute() missing 2 required positional arguments: 'type' and 'schema'
[2024-07-02T20:47:21.212+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T204720, end_date=20240702T204721
[2024-07-02T20:47:21.883+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 11 for task customer (execute() missing 2 required positional arguments: 'type' and 'schema'; 94)
[2024-07-02T20:47:21.939+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:47:22.334+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:49:58.347+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:49:58.398+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:49:58.404+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:49:58.441+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:49:58.469+0000] {standard_task_runner.py:60} INFO - Started process 101 to run task
[2024-07-02T20:49:58.490+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp7qg3qrfe']
[2024-07-02T20:49:58.499+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask customer
[2024-07-02T20:49:58.722+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 82e116e15bed
[2024-07-02T20:49:59.896+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:49:59.900+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:49:59.901+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:49:59.903+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:customer
[2024-07-02T20:49:59.904+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, table)
TypeError: some_function() missing 2 required positional arguments: 'schema' and 'table'
[2024-07-02T20:49:59.916+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T204958, end_date=20240702T204959
[2024-07-02T20:49:59.937+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 15 for task customer (some_function() missing 2 required positional arguments: 'schema' and 'table'; 101)
[2024-07-02T20:49:59.971+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:50:00.001+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:51:51.161+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:51:51.173+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:51:51.174+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:51:51.225+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:51:51.251+0000] {standard_task_runner.py:60} INFO - Started process 96 to run task
[2024-07-02T20:51:51.259+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '11', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmptwu5k411']
[2024-07-02T20:51:51.285+0000] {standard_task_runner.py:88} INFO - Job 11: Subtask customer
[2024-07-02T20:51:51.533+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host 910796d1882f
[2024-07-02T20:51:53.025+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:51:53.027+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:51:53.032+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:51:53.036+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:customer
[2024-07-02T20:51:53.067+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, table)
  File "/app/concretestage/SQLToStaging.py", line 30, in some_function
    df = get_data_from_conf_table(table, stage)
  File "/app/myFramework/utils/utils.py", line 142, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-02T20:51:53.088+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T205151, end_date=20240702T205153
[2024-07-02T20:51:53.107+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 11 for task customer (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 96)
[2024-07-02T20:51:53.131+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:51:53.172+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:54:17.539+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:54:17.567+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:54:17.570+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:54:17.599+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): customer> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:54:17.607+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-02T20:54:17.619+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'customer', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpesbw1n7n']
[2024-07-02T20:54:17.636+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask customer
[2024-07-02T20:54:17.854+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.customer scheduled__2024-07-01T00:00:00+00:00 [running]> on host df9727a9ba29
[2024-07-02T20:54:18.040+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='customer' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:54:18.052+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:54:18.055+0000] {logging_mixin.py:188} INFO - table: customer
[2024-07-02T20:54:18.060+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:customer
[2024-07-02T20:54:19.090+0000] {logging_mixin.py:188} INFO - 0    dvdrental
Name: sourcedbname, dtype: object 
 0    staff
Name: sourcetablename, dtype: object 
 0    public
Name: sourceschema, dtype: object
[2024-07-02T20:54:19.092+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:54:19.114+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=customer, execution_date=20240701T000000, start_date=20240702T205417, end_date=20240702T205419
[2024-07-02T20:54:19.155+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:54:19.172+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
