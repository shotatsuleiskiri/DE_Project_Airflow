[2024-07-02T18:42:24.407+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:42:24.454+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:42:24.464+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T18:42:24.514+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T18:42:24.534+0000] {standard_task_runner.py:60} INFO - Started process 101 to run task
[2024-07-02T18:42:24.544+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp1n7uf972']
[2024-07-02T18:42:24.550+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask payment
[2024-07-02T18:42:24.719+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 5b7251376729
[2024-07-02T18:42:25.897+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T18:42:25.920+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
TypeError: process_table() missing 1 required positional argument: 'table_type'
[2024-07-02T18:42:25.935+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T184224, end_date=20240702T184225
[2024-07-02T18:42:26.042+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 13 for task payment (process_table() missing 1 required positional argument: 'table_type'; 101)
[2024-07-02T18:42:26.081+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T18:42:26.148+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T18:50:28.349+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:50:28.383+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T18:50:28.388+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T18:50:28.460+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T18:50:28.467+0000] {standard_task_runner.py:60} INFO - Started process 96 to run task
[2024-07-02T18:50:28.486+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpvsnbkb8t']
[2024-07-02T18:50:28.501+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask payment
[2024-07-02T18:50:28.622+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host e236fd1115af
[2024-07-02T18:50:29.519+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T18:50:29.522+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T18:50:29.536+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T18:50:29.547+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T18:50:29.585+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 25, in some_function
    sourceDF = getDF(yaml.getSourceDBName(), yaml.getTSourceTableName(),yaml.getSourceSchema())
  File "/app/myFramework/utils/readYaml.py", line 25, in getSourceDBName
    return self.getYaml()['SourceDBName']
  File "/app/myFramework/utils/readYaml.py", line 18, in getYaml
    return yaml_data[self.key]
KeyError: 'public.payment'
[2024-07-02T18:50:29.630+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T185028, end_date=20240702T185029
[2024-07-02T18:50:29.659+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task payment ('public.payment'; 96)
[2024-07-02T18:50:29.671+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T18:50:29.732+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:20:13.106+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:20:13.126+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:20:13.140+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:20:13.192+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:20:13.210+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-02T20:20:13.238+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8cz56yg6']
[2024-07-02T20:20:13.294+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask payment
[2024-07-02T20:20:13.535+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 881b4526a2de
[2024-07-02T20:20:14.875+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:20:14.888+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:20:14.894+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:20:14.914+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:20:14.962+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 29, in some_function
    print(get_data_from_conf_table("staff", "SqlToStaging"))
  File "/app/myFramework/utils/utils.py", line 137, in get_data_from_conf_table
    cur = conn.getCursor("Postgres")
  File "/app/myFramework/source/posgresql/connect.py", line 6, in getCursor
    conn = psycopg2.connect(database = dbname,
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "postgres_db" (172.20.0.3), port 9999 failed: FATAL:  database "Postgres" does not exist

[2024-07-02T20:20:14.973+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T202013, end_date=20240702T202014
[2024-07-02T20:20:15.079+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 13 for task payment (connection to server at "postgres_db" (172.20.0.3), port 9999 failed: FATAL:  database "Postgres" does not exist
; 97)
[2024-07-02T20:20:15.133+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:20:15.241+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:22:14.329+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:22:14.339+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:22:14.345+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:22:14.386+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:22:14.413+0000] {standard_task_runner.py:60} INFO - Started process 103 to run task
[2024-07-02T20:22:14.442+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmptd6r7_ix']
[2024-07-02T20:22:14.458+0000] {standard_task_runner.py:88} INFO - Job 17: Subtask payment
[2024-07-02T20:22:14.727+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host b2ca66e4d1f6
[2024-07-02T20:22:16.026+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:22:16.052+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:22:16.073+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:22:16.086+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:22:16.160+0000] {logging_mixin.py:188} INFO -    0      1          2       3     4   ...    10    11    12            13    14
0   9  staff  dvdrental  public  full  ...  None  None  None  SqlToStaging  None

[1 rows x 15 columns]
[2024-07-02T20:22:16.161+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:22:16.178+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T202214, end_date=20240702T202216
[2024-07-02T20:22:16.254+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:22:16.361+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:25:37.698+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:25:37.711+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:25:37.713+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:25:37.747+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:25:37.757+0000] {standard_task_runner.py:60} INFO - Started process 100 to run task
[2024-07-02T20:25:37.781+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp15rwis0a']
[2024-07-02T20:25:37.794+0000] {standard_task_runner.py:88} INFO - Job 12: Subtask payment
[2024-07-02T20:25:37.943+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host e847a37dafab
[2024-07-02T20:25:39.202+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:25:39.206+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:25:39.207+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:25:39.210+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:25:39.297+0000] {logging_mixin.py:188} INFO - <class 'pandas.core.frame.DataFrame'>
[2024-07-02T20:25:39.415+0000] {logging_mixin.py:188} INFO -    id sourcetablename sourcedbname  ...  code         stage last_run_date
0   9           staff    dvdrental  ...  None  SqlToStaging          None

[1 rows x 15 columns]
[2024-07-02T20:25:39.418+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:25:39.427+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T202537, end_date=20240702T202539
[2024-07-02T20:25:39.463+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:25:39.528+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:33:53.679+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:33:53.719+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:33:53.726+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:33:53.759+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:33:53.781+0000] {standard_task_runner.py:60} INFO - Started process 95 to run task
[2024-07-02T20:33:53.797+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpcob0njgg']
[2024-07-02T20:33:53.807+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask payment
[2024-07-02T20:33:53.942+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 99fbc1087931
[2024-07-02T20:33:55.297+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:33:55.304+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:33:55.306+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:33:55.311+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:33:55.348+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SourceDBName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 30, in some_function
    print(f"{df['SourceDBName']} \n {df['SourceTableName']} \n {df['SourceSchema']}")
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'SourceDBName'
[2024-07-02T20:33:55.375+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T203353, end_date=20240702T203355
[2024-07-02T20:33:55.395+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task payment ('SourceDBName'; 95)
[2024-07-02T20:33:55.405+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:33:55.422+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:36:07.897+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:36:07.905+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:36:07.907+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:36:07.929+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:36:07.952+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-02T20:36:07.955+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpcurcdq_q']
[2024-07-02T20:36:07.962+0000] {standard_task_runner.py:88} INFO - Job 12: Subtask payment
[2024-07-02T20:36:08.128+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 8ef3b2afa95a
[2024-07-02T20:36:09.141+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:36:09.147+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:36:09.148+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:36:09.149+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:36:09.192+0000] {logging_mixin.py:188} INFO - 0    dvdrental
Name: sourcedbname, dtype: object 
 0    staff
Name: sourcetablename, dtype: object 
 0    public
Name: sourceschema, dtype: object
[2024-07-02T20:36:09.198+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:36:09.224+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T203607, end_date=20240702T203609
[2024-07-02T20:36:09.336+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:36:09.360+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:40:31.158+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:40:31.185+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:40:31.201+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:40:31.237+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:40:31.291+0000] {standard_task_runner.py:60} INFO - Started process 93 to run task
[2024-07-02T20:40:31.302+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmps77kecm2']
[2024-07-02T20:40:31.311+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask payment
[2024-07-02T20:40:31.555+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host f7a45131ad00
[2024-07-02T20:40:31.841+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:40:31.871+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:40:31.885+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:40:31.967+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:40:32.902+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage, "FULL","public")
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, type, schema, table)
  File "/app/concretestage/SQLToStaging.py", line 29, in some_function
    df = get_data_from_conf_table(table, stage)
  File "/app/myFramework/utils/utils.py", line 142, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-02T20:40:32.923+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T204031, end_date=20240702T204032
[2024-07-02T20:40:32.974+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task payment (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 93)
[2024-07-02T20:40:33.042+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:40:33.101+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:44:45.032+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:44:45.042+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:44:45.043+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:44:45.059+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:44:45.072+0000] {standard_task_runner.py:60} INFO - Started process 88 to run task
[2024-07-02T20:44:45.076+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpxgnlqilw']
[2024-07-02T20:44:45.088+0000] {standard_task_runner.py:88} INFO - Job 4: Subtask payment
[2024-07-02T20:44:45.226+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 28c1247628aa
[2024-07-02T20:44:46.195+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:44:46.198+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:44:46.202+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:44:46.203+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 type: FULL 
 schema: public 
 table:payment
[2024-07-02T20:44:46.210+0000] {logging_mixin.py:188} INFO - sqltostaging payment
[2024-07-02T20:44:46.213+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:44:46.243+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T204445, end_date=20240702T204446
[2024-07-02T20:44:46.334+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:44:46.378+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:47:20.721+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:47:20.764+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:47:20.780+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:47:20.805+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:47:20.828+0000] {standard_task_runner.py:60} INFO - Started process 95 to run task
[2024-07-02T20:47:20.839+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp51rwtp24']
[2024-07-02T20:47:20.850+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask payment
[2024-07-02T20:47:21.031+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 0dbf5a897656
[2024-07-02T20:47:22.217+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:47:22.237+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:47:22.241+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:47:22.244+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
TypeError: execute() missing 2 required positional arguments: 'type' and 'schema'
[2024-07-02T20:47:22.273+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T204720, end_date=20240702T204722
[2024-07-02T20:47:22.441+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task payment (execute() missing 2 required positional arguments: 'type' and 'schema'; 95)
[2024-07-02T20:47:22.484+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:47:22.508+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:49:58.219+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:49:58.230+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:49:58.234+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:49:58.309+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:49:58.319+0000] {standard_task_runner.py:60} INFO - Started process 93 to run task
[2024-07-02T20:49:58.336+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpaqifdwi6']
[2024-07-02T20:49:58.341+0000] {standard_task_runner.py:88} INFO - Job 6: Subtask payment
[2024-07-02T20:49:58.477+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 82e116e15bed
[2024-07-02T20:49:59.933+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:49:59.935+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:49:59.938+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:49:59.941+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:payment
[2024-07-02T20:49:59.943+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, table)
TypeError: some_function() missing 2 required positional arguments: 'schema' and 'table'
[2024-07-02T20:49:59.958+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T204958, end_date=20240702T204959
[2024-07-02T20:49:59.977+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 6 for task payment (some_function() missing 2 required positional arguments: 'schema' and 'table'; 93)
[2024-07-02T20:50:00.016+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:50:00.037+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:51:51.313+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:51:51.366+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:51:51.368+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:51:51.439+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:51:51.463+0000] {standard_task_runner.py:60} INFO - Started process 99 to run task
[2024-07-02T20:51:51.488+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp_bz23hmv']
[2024-07-02T20:51:51.493+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask payment
[2024-07-02T20:51:51.669+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host 910796d1882f
[2024-07-02T20:51:52.770+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:51:52.778+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:51:52.779+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:51:52.779+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:payment
[2024-07-02T20:51:52.804+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 22, in process_table
    return  execute(table, stage)
  File "/app/main.py", line 25, in execute
    SqlToStaging().create_full().some_function(stage, table)
  File "/app/concretestage/SQLToStaging.py", line 30, in some_function
    df = get_data_from_conf_table(table, stage)
  File "/app/myFramework/utils/utils.py", line 142, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-02T20:51:52.820+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T205151, end_date=20240702T205152
[2024-07-02T20:51:52.887+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task payment (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 99)
[2024-07-02T20:51:52.955+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-02T20:51:53.025+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-02T20:54:17.547+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:54:17.556+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2024-07-02T20:54:17.565+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-02T20:54:17.602+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): payment> on 2024-07-01 00:00:00+00:00
[2024-07-02T20:54:17.621+0000] {standard_task_runner.py:60} INFO - Started process 100 to run task
[2024-07-02T20:54:17.655+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sqltostaging', 'payment', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp7gu2viuv']
[2024-07-02T20:54:17.667+0000] {standard_task_runner.py:88} INFO - Job 10: Subtask payment
[2024-07-02T20:54:17.857+0000] {task_command.py:423} INFO - Running <TaskInstance: sqltostaging.payment scheduled__2024-07-01T00:00:00+00:00 [running]> on host df9727a9ba29
[2024-07-02T20:54:18.994+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sqltostaging' AIRFLOW_CTX_TASK_ID='payment' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2024-07-02T20:54:19.011+0000] {logging_mixin.py:188} INFO - dvtobv :dag_id
[2024-07-02T20:54:19.014+0000] {logging_mixin.py:188} INFO - table: payment
[2024-07-02T20:54:19.027+0000] {logging_mixin.py:188} INFO - 
 stage: sqltostaging 
 table:payment
[2024-07-02T20:54:19.063+0000] {logging_mixin.py:188} INFO - 0    dvdrental
Name: sourcedbname, dtype: object 
 0    staff
Name: sourcetablename, dtype: object 
 0    public
Name: sourceschema, dtype: object
[2024-07-02T20:54:19.065+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-02T20:54:19.075+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sqltostaging, task_id=payment, execution_date=20240701T000000, start_date=20240702T205417, end_date=20240702T205419
[2024-07-02T20:54:19.161+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-02T20:54:19.188+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
