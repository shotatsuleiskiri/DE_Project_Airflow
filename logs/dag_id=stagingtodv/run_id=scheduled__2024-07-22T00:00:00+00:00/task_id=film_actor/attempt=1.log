[2024-07-23T17:12:33.414+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:12:33.432+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:12:33.438+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T17:12:33.466+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T17:12:33.476+0000] {standard_task_runner.py:60} INFO - Started process 90 to run task
[2024-07-23T17:12:33.482+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '29', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpmu5fc44s']
[2024-07-23T17:12:33.504+0000] {standard_task_runner.py:88} INFO - Job 29: Subtask film_actor
[2024-07-23T17:12:33.621+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host f59a56d3cdcb
[2024-07-23T17:12:33.858+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T17:12:33.965+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T17:12:34.565+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 41, in process_table
    tabletype = get_data_from_conf_table(table,stage)['tabletype'].values[0]
  File "/opt/airflow/dags/dag.py", line 34, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-23T17:12:34.590+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T171233, end_date=20240723T171234
[2024-07-23T17:12:34.612+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 29 for task film_actor (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 90)
[2024-07-23T17:12:34.650+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T17:12:34.679+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T17:54:16.354+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:54:16.364+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:54:16.370+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T17:54:16.413+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T17:54:16.423+0000] {standard_task_runner.py:60} INFO - Started process 86 to run task
[2024-07-23T17:54:16.443+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpw27tbvix']
[2024-07-23T17:54:16.458+0000] {standard_task_runner.py:88} INFO - Job 10: Subtask film_actor
[2024-07-23T17:54:16.577+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host 3c1c8f0ee07d
[2024-07-23T17:54:17.648+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T17:54:17.661+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T17:54:17.877+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 28, in getDF
    cur.execute(query)
psycopg2.errors.UndefinedTable: relation "dvdrental.film_actor" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_actor T
                        ^

[2024-07-23T17:54:17.897+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T175416, end_date=20240723T175417
[2024-07-23T17:54:17.913+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 10 for task film_actor (relation "dvdrental.film_actor" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_actor T
                        ^
; 86)
[2024-07-23T17:54:17.960+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T17:54:17.975+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:01:02.212+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:01:02.243+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:01:02.244+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:01:02.305+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:01:02.322+0000] {standard_task_runner.py:60} INFO - Started process 94 to run task
[2024-07-23T18:01:02.325+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpxq8adibt']
[2024-07-23T18:01:02.333+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask film_actor
[2024-07-23T18:01:02.480+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host 315a231b27e5
[2024-07-23T18:01:03.497+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:01:03.502+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T18:01:03.657+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 28, in getDF
    cur.execute(query)
psycopg2.errors.UndefinedTable: relation "dvdrental.film_actor" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_actor T
                        ^

[2024-07-23T18:01:03.665+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T180102, end_date=20240723T180103
[2024-07-23T18:01:03.673+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task film_actor (relation "dvdrental.film_actor" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_actor T
                        ^
; 94)
[2024-07-23T18:01:03.720+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:01:03.733+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:04:01.192+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:04:01.203+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:04:01.205+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:04:01.229+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:04:01.234+0000] {standard_task_runner.py:60} INFO - Started process 90 to run task
[2024-07-23T18:04:01.243+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp1xd84fo1']
[2024-07-23T18:04:01.259+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask film_actor
[2024-07-23T18:04:01.374+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host e53715a5cddb
[2024-07-23T18:04:02.392+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:04:02.406+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T18:04:02.528+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 31, in getDF
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 3 elements
[2024-07-23T18:04:02.538+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T180401, end_date=20240723T180402
[2024-07-23T18:04:02.546+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task film_actor (Length mismatch: Expected axis has 0 elements, new values have 3 elements; 90)
[2024-07-23T18:04:02.597+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:04:02.608+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:06:47.987+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:06:47.997+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:06:48.001+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:06:48.029+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:06:48.033+0000] {standard_task_runner.py:60} INFO - Started process 85 to run task
[2024-07-23T18:06:48.038+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8pgnlp8p']
[2024-07-23T18:06:48.042+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask film_actor
[2024-07-23T18:06:48.174+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host 4611c3991cbb
[2024-07-23T18:06:48.731+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:06:48.750+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T18:06:49.119+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T18:06:49.154+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T180647, end_date=20240723T180649
[2024-07-23T18:06:49.200+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task film_actor ('(film_id,actor_id)'; 85)
[2024-07-23T18:06:49.248+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:06:49.294+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:29:37.520+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:29:37.546+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:29:37.548+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:29:37.566+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:29:37.573+0000] {standard_task_runner.py:60} INFO - Started process 91 to run task
[2024-07-23T18:29:37.584+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp6popuh9i']
[2024-07-23T18:29:37.600+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask film_actor
[2024-07-23T18:29:37.745+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host c954f6e68ded
[2024-07-23T18:29:38.723+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:29:38.725+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T18:29:38.823+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T18:29:38.835+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T182937, end_date=20240723T182938
[2024-07-23T18:29:38.842+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task film_actor ('(film_id,actor_id)'; 91)
[2024-07-23T18:29:38.901+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:29:38.914+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:03:40.361+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:03:40.380+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:03:40.382+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:03:40.425+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:03:40.432+0000] {standard_task_runner.py:60} INFO - Started process 82 to run task
[2024-07-23T19:03:40.443+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmppcfxkbq8']
[2024-07-23T19:03:40.452+0000] {standard_task_runner.py:88} INFO - Job 4: Subtask film_actor
[2024-07-23T19:03:40.574+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host fc8d45b704f5
[2024-07-23T19:03:41.459+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:03:41.460+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T19:03:41.695+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T19:03:41.705+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T190340, end_date=20240723T190341
[2024-07-23T19:03:41.713+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 4 for task film_actor ('(film_id,actor_id)'; 82)
[2024-07-23T19:03:41.726+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:03:41.738+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:14:05.098+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:14:05.110+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:14:05.111+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:14:05.151+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:14:05.161+0000] {standard_task_runner.py:60} INFO - Started process 104 to run task
[2024-07-23T19:14:05.171+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpiydhek6e']
[2024-07-23T19:14:05.190+0000] {standard_task_runner.py:88} INFO - Job 12: Subtask film_actor
[2024-07-23T19:14:05.336+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host 232d821b4a3b
[2024-07-23T19:14:06.346+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:14:06.352+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T19:14:06.525+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T19:14:06.552+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T191405, end_date=20240723T191406
[2024-07-23T19:14:06.562+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 12 for task film_actor ('(film_id,actor_id)'; 104)
[2024-07-23T19:14:06.589+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:14:06.622+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:16:53.776+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:16:53.792+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:16:53.794+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:16:53.826+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:16:53.838+0000] {standard_task_runner.py:60} INFO - Started process 100 to run task
[2024-07-23T19:16:53.858+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp_vdncjp1']
[2024-07-23T19:16:53.862+0000] {standard_task_runner.py:88} INFO - Job 3: Subtask film_actor
[2024-07-23T19:16:54.013+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host edd08a02182b
[2024-07-23T19:16:55.199+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:16:55.204+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T19:16:55.358+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T19:16:55.370+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T191653, end_date=20240723T191655
[2024-07-23T19:16:55.384+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 3 for task film_actor ('(film_id,actor_id)'; 100)
[2024-07-23T19:16:55.424+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:16:55.462+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:24:54.829+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:24:54.849+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:24:54.852+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:24:54.892+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_actor> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:24:54.897+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-23T19:24:54.918+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_actor', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp9z7jktas']
[2024-07-23T19:24:54.928+0000] {standard_task_runner.py:88} INFO - Job 10: Subtask film_actor
[2024-07-23T19:24:55.104+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_actor scheduled__2024-07-22T00:00:00+00:00 [running]> on host b19a9c320dfd
[2024-07-23T19:24:56.306+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_actor' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:24:56.316+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_actor' and Stage = 'stagingtodv'
[2024-07-23T19:24:56.467+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,actor_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,actor_id)'
[2024-07-23T19:24:56.494+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_actor, execution_date=20240722T000000, start_date=20240723T192454, end_date=20240723T192456
[2024-07-23T19:24:56.509+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 10 for task film_actor ('(film_id,actor_id)'; 97)
[2024-07-23T19:24:56.531+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:24:56.569+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
