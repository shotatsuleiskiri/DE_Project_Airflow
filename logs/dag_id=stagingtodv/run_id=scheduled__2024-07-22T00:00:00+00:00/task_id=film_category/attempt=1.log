[2024-07-23T17:12:33.462+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:12:33.494+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:12:33.502+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T17:12:33.538+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T17:12:33.570+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '32', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp7_e5isnq']
[2024-07-23T17:12:33.566+0000] {standard_task_runner.py:60} INFO - Started process 94 to run task
[2024-07-23T17:12:33.585+0000] {standard_task_runner.py:88} INFO - Job 32: Subtask film_category
[2024-07-23T17:12:33.702+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host f59a56d3cdcb
[2024-07-23T17:12:33.832+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T17:12:33.953+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T17:12:34.540+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 41, in process_table
    tabletype = get_data_from_conf_table(table,stage)['tabletype'].values[0]
  File "/opt/airflow/dags/dag.py", line 34, in get_data_from_conf_table
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 15 elements
[2024-07-23T17:12:34.573+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T171233, end_date=20240723T171234
[2024-07-23T17:12:34.608+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 32 for task film_category (Length mismatch: Expected axis has 0 elements, new values have 15 elements; 94)
[2024-07-23T17:12:34.649+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T17:12:34.672+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T17:54:16.351+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:54:16.369+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T17:54:16.370+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T17:54:16.385+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T17:54:16.396+0000] {standard_task_runner.py:60} INFO - Started process 81 to run task
[2024-07-23T17:54:16.405+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpecj__pwe']
[2024-07-23T17:54:16.413+0000] {standard_task_runner.py:88} INFO - Job 7: Subtask film_category
[2024-07-23T17:54:16.543+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host 3c1c8f0ee07d
[2024-07-23T17:54:17.613+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T17:54:17.623+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T17:54:17.877+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 28, in getDF
    cur.execute(query)
psycopg2.errors.UndefinedTable: relation "dvdrental.film_category" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_category T
                        ^

[2024-07-23T17:54:17.892+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T175416, end_date=20240723T175417
[2024-07-23T17:54:17.916+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 7 for task film_category (relation "dvdrental.film_category" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_category T
                        ^
; 81)
[2024-07-23T17:54:17.951+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T17:54:17.965+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:01:02.093+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:01:02.101+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:01:02.101+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:01:02.116+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:01:02.125+0000] {standard_task_runner.py:60} INFO - Started process 81 to run task
[2024-07-23T18:01:02.138+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpralg5rz0']
[2024-07-23T18:01:02.143+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask film_category
[2024-07-23T18:01:02.325+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host 315a231b27e5
[2024-07-23T18:01:03.231+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:01:03.240+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T18:01:03.438+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 28, in getDF
    cur.execute(query)
psycopg2.errors.UndefinedTable: relation "dvdrental.film_category" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_category T
                        ^

[2024-07-23T18:01:03.455+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T180102, end_date=20240723T180103
[2024-07-23T18:01:03.478+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task film_category (relation "dvdrental.film_category" does not exist
LINE 1: select T.* from dbdv.dvdrental.film_category T
                        ^
; 81)
[2024-07-23T18:01:03.504+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:01:03.521+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:04:01.256+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:04:01.269+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:04:01.270+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:04:01.293+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:04:01.302+0000] {standard_task_runner.py:60} INFO - Started process 99 to run task
[2024-07-23T18:04:01.323+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpfoy142_w']
[2024-07-23T18:04:01.334+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask film_category
[2024-07-23T18:04:01.494+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host e53715a5cddb
[2024-07-23T18:04:02.505+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:04:02.507+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T18:04:02.568+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 100, in some_function
    dest_col_list = list(getDF(DestDBName, DestTableName,DestSchema).columns)
  File "/app/myFramework/utils/utils.py", line 31, in getDF
    df.columns = [desc[0] for desc in cur.description]
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 6002, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 730, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/managers.py", line 225, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/internals/base.py", line 70, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 0 elements, new values have 3 elements
[2024-07-23T18:04:02.581+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T180401, end_date=20240723T180402
[2024-07-23T18:04:02.592+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 13 for task film_category (Length mismatch: Expected axis has 0 elements, new values have 3 elements; 99)
[2024-07-23T18:04:02.610+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:04:02.623+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:06:47.997+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:06:48.024+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:06:48.033+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:06:48.051+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:06:48.061+0000] {standard_task_runner.py:60} INFO - Started process 87 to run task
[2024-07-23T18:06:48.067+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpfen2_zys']
[2024-07-23T18:06:48.075+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask film_category
[2024-07-23T18:06:48.206+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host 4611c3991cbb
[2024-07-23T18:06:49.204+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:06:49.208+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T18:06:49.349+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_Link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T18:06:49.361+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T180648, end_date=20240723T180649
[2024-07-23T18:06:49.370+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task film_category ('(film_id,category_id)'; 87)
[2024-07-23T18:06:49.406+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:06:49.419+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T18:29:37.491+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:29:37.504+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T18:29:37.509+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T18:29:37.527+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T18:29:37.532+0000] {standard_task_runner.py:60} INFO - Started process 89 to run task
[2024-07-23T18:29:37.536+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpl_cv4lj7']
[2024-07-23T18:29:37.540+0000] {standard_task_runner.py:88} INFO - Job 4: Subtask film_category
[2024-07-23T18:29:37.642+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host c954f6e68ded
[2024-07-23T18:29:38.155+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T18:29:38.161+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T18:29:38.664+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T18:29:38.719+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T182937, end_date=20240723T182938
[2024-07-23T18:29:38.743+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 4 for task film_category ('(film_id,category_id)'; 89)
[2024-07-23T18:29:38.784+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T18:29:38.797+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:03:40.397+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:03:40.412+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:03:40.418+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:03:40.444+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:03:40.459+0000] {standard_task_runner.py:60} INFO - Started process 83 to run task
[2024-07-23T19:03:40.472+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpa86nxozk']
[2024-07-23T19:03:40.486+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask film_category
[2024-07-23T19:03:40.616+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host fc8d45b704f5
[2024-07-23T19:03:41.623+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:03:41.625+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T19:03:41.743+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T19:03:41.756+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T190340, end_date=20240723T190341
[2024-07-23T19:03:41.769+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task film_category ('(film_id,category_id)'; 83)
[2024-07-23T19:03:41.783+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:03:41.795+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:14:05.034+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:14:05.047+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:14:05.050+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:14:05.071+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:14:05.081+0000] {standard_task_runner.py:60} INFO - Started process 97 to run task
[2024-07-23T19:14:05.089+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpgvha6f_q']
[2024-07-23T19:14:05.109+0000] {standard_task_runner.py:88} INFO - Job 6: Subtask film_category
[2024-07-23T19:14:05.229+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host 232d821b4a3b
[2024-07-23T19:14:06.414+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:14:06.415+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T19:14:06.562+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T19:14:06.581+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T191405, end_date=20240723T191406
[2024-07-23T19:14:06.589+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 6 for task film_category ('(film_id,category_id)'; 97)
[2024-07-23T19:14:06.628+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:14:06.649+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:16:53.781+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:16:53.799+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:16:53.806+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:16:53.827+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:16:53.845+0000] {standard_task_runner.py:60} INFO - Started process 98 to run task
[2024-07-23T19:16:53.852+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpm6b0z5pq']
[2024-07-23T19:16:53.859+0000] {standard_task_runner.py:88} INFO - Job 7: Subtask film_category
[2024-07-23T19:16:53.957+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host edd08a02182b
[2024-07-23T19:16:55.006+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:16:55.017+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T19:16:55.360+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T19:16:55.371+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T191653, end_date=20240723T191655
[2024-07-23T19:16:55.393+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 7 for task film_category ('(film_id,category_id)'; 98)
[2024-07-23T19:16:55.425+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:16:55.474+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-23T19:24:54.934+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:24:54.951+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [queued]>
[2024-07-23T19:24:54.959+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-23T19:24:54.989+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): film_category> on 2024-07-22 00:00:00+00:00
[2024-07-23T19:24:54.993+0000] {standard_task_runner.py:60} INFO - Started process 102 to run task
[2024-07-23T19:24:55.012+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'stagingtodv', 'film_category', 'scheduled__2024-07-22T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8isixx_p']
[2024-07-23T19:24:55.023+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask film_category
[2024-07-23T19:24:55.212+0000] {task_command.py:423} INFO - Running <TaskInstance: stagingtodv.film_category scheduled__2024-07-22T00:00:00+00:00 [running]> on host b19a9c320dfd
[2024-07-23T19:24:56.308+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='stagingtodv' AIRFLOW_CTX_TASK_ID='film_category' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T00:00:00+00:00'
[2024-07-23T19:24:56.310+0000] {logging_mixin.py:188} INFO - -------------------------------------------- select *  from etlconf.Etl_Process_Mapping where SourceTableName = 'film_category' and Stage = 'stagingtodv'
[2024-07-23T19:24:56.455+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '(film_id,category_id)'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/dag.py", line 45, in process_table
    return  execute(table, stage, tabletype)
  File "/app/main.py", line 35, in execute
    StagingToDV().create_link().some_function(table, stage)
  File "/app/concretestage/StagingToDV.py", line 101, in some_function
    genaretedDF = generateSurogateKey(sourceDF, Code, list(SurogateKey.split(" ")),dest_col_list)
  File "/app/myFramework/utils/utils.py", line 55, in generateSurogateKey
    Surogatekey = newdf[key]+int(str(1000000) + str(code))
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: '(film_id,category_id)'
[2024-07-23T19:24:56.482+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=stagingtodv, task_id=film_category, execution_date=20240722T000000, start_date=20240723T192454, end_date=20240723T192456
[2024-07-23T19:24:56.492+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 15 for task film_category ('(film_id,category_id)'; 102)
[2024-07-23T19:24:56.531+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-23T19:24:56.556+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
